<!-- planos.html: 3 planos (semestral, trimestral, mensal), títulos sim -->
<style>
  :root {
    --primary-color: #48BB78;
    --primary-dark: #2e7d32;
    --secondary-color: #8BC34A;
    --accent-color: #48BB78;
    --accent-dark: #2e7d32;
    --text-color: #2D3748;
    --light-bg: #F7FAFC;
    --white: #FFFFFF;
    --footer-bg: #222831;
    --shadow: 0 2px 8px rgba(44, 82, 130, 0.07);
    --transition: .2s;
  }
  .planos-section { background: var(--light-bg); border-radius: 30px; box-shadow: 0 8px 32px 0 rgba(44, 62, 80, 0.10); padding: 3rem 1rem 5rem 1rem; max-width: 1200px; margin: 3rem auto; color: var(--text-color);}
  .planos-titulo { color: var(--primary-dark); font-size: 2.2rem; font-weight: 700; letter-spacing: .5px; margin-bottom: .7rem; text-align: center;}
  .planos-descricao { color: var(--text-color); font-size: 1.14rem; margin-bottom: 2.2rem; text-align: center;}
  .nivel-container { background: var(--white); border-radius: 18px; padding: 1.7rem 1.5rem 1.5rem 1.5rem; margin-bottom: 1.8rem; box-shadow: var(--shadow); max-width: 530px; margin-left: auto; margin-right: auto;}
  .nivel-titulos { display: flex; justify-content: space-between; margin-bottom: 0.7rem; margin-top: 0.2rem; width: 100%;}
  .nivel-titulo-item { flex: 1 1 0; text-align: center; font-size: 1.08rem; font-weight: 700; color: var(--primary-dark); min-width: 0; padding: 0 4px; white-space: normal; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; letter-spacing:0.01em;}
  .nivel-slider-area { position: relative; width: 100%; margin-bottom: 1.2rem; margin-top: 0.1rem; height: 40px;}
  .nivel-slider-bg { position: absolute; left: 0; right: 0; top: 50%; transform: translateY(-50%); height: 10px; border-radius: 6px; background: linear-gradient(90deg, #48BB78 0%, #FFD600 50%, #E53935 100%); z-index: 1; width: 100%; pointer-events: none;}
  .nivel-slider-fill { position: absolute; left: 0; top: 50%; transform: translateY(-50%); height: 10px; border-radius: 6px 0 0 6px; background: linear-gradient(90deg, #48BB78 0%, #FFD600 50%, #E53935 100%); z-index: 2; pointer-events: none; transition: width .3s, background .3s;}
  .nivel-slider { width: 100%; height: 40px; background: transparent; outline: none; appearance: none; position: absolute; left: 0; top: 0; z-index: 4; margin: 0; cursor: pointer;}
  .nivel-slider::-webkit-slider-thumb { appearance: none; width: 28px; height: 28px; border-radius: 50%; background: #fff; border: 3px solid var(--thumb-border, #48BB78); box-shadow: 0 2px 6px #d9f8ec80; transition: border .2s; cursor: pointer; position: relative; z-index: 5;}
  .nivel-slider:focus::-webkit-slider-thumb { border: 3px solid #FFD600;}
  .nivel-slider::-moz-range-thumb { width: 28px; height: 28px; border-radius: 50%; background: #fff; border: 3px solid var(--thumb-border, #48BB78); box-shadow: 0 2px 6px #d9f8ec80; transition: border .2s; cursor: pointer; position: relative; z-index: 5;}
  .nivel-slider:focus::-moz-range-thumb { border: 3px solid #FFD600;}
  .nivel-slider::-ms-thumb { width: 28px; height: 28px; border-radius: 50%; background: #fff; border: 3px solid var(--thumb-border, #48BB78); box-shadow: 0 2px 6px #d9f8ec80; transition: border .2s; cursor: pointer; position: relative; z-index: 5;}
  .nivel-slider::-webkit-slider-runnable-track { height: 10px; background: transparent;}
  .nivel-slider::-ms-fill-lower, .nivel-slider::-ms-fill-upper { background: transparent;}
  .slider-markers { position: absolute; left: 0; right: 0; top: 50%; transform: translateY(-50%); width: 100%; height: 0; z-index: 10; pointer-events: none;}
  .slider-dot { position: absolute; width: 14px; height: 14px; background: #222; border-radius: 50%; top: 50%; transform: translate(-50%, -50%); box-shadow: 0 0 0 3px #fff; border: 2px solid #222; pointer-events: none; z-index: 11;}
  .nivel-labels { margin-top: 1.1rem; font-size: 1.08rem; color: var(--primary-dark); font-weight: 500; text-align: center;}
  .plano-btn { padding: 0.65rem 1.7rem; margin: 0 0.5rem; background: var(--primary-color); border: none; border-radius: 25px; cursor: pointer; font-weight: bold; color: var(--white); font-size: 1rem; transition: background var(--transition), color var(--transition); outline: none; box-shadow: none;}
  .plano-btn.active, .plano-btn:hover { background: var(--primary-dark); color: var(--white); box-shadow: none;}
  .carousel-container { position: relative; width: 100%; overflow: hidden; margin: 0 auto; max-width: 1000px; background: var(--white); border-radius: 22px; box-shadow: 0 2px 16px #c4e3d733; padding: 2.2rem 0 1.7rem 0; color: var(--text-color);}
  .carousel-track { display: flex; transition: transform 0.5s cubic-bezier(.4,0,.2,1); min-height: 370px; will-change: transform;}
  .plano-card { min-width: 320px; max-width: 350px; margin: 0 1.1rem; background: var(--white); border-radius: 22px; padding: 2rem 1.1rem 2.2rem 1.1rem; box-shadow: 0 8px 32px 0 rgba(44, 62, 80, 0.13); display: flex; flex-direction: column; align-items: center; justify-content: flex-start; flex-shrink: 0; user-select: none; border: 2.5px solid var(--secondary-color); position: relative; animation: fadeIn .6s; transition: box-shadow 0.2s, border 0.2s; color: var(--text-color);}
  .plano-card:hover { box-shadow: 0 12px 42px 0 rgba(44, 62, 80, 0.18); border: 2.5px solid var(--primary-color);}
  .plano-card img { width: 100%; height: 150px; object-fit: cover; border-radius: 12px; margin-bottom: 1.2rem; box-shadow: 0 2px 10px var(--secondary-color); border: 1.5px solid var(--primary-color);}
  .plano-card h3 { color: var(--primary-dark); font-size: 1.2rem; margin-bottom: 0.8rem; font-weight: 700;}
  .preco-profissional { margin: 1.7rem 0 0.5rem 0; text-align: center;}
  .preco-mensal { font-size: 2.1rem; font-weight: 800; color: var(--primary-dark); display:inline-block; line-height: 1.05; letter-spacing: -0.5px;}
  .preco-mensal strong { font-weight: 900; letter-spacing: -1.5px;}
  .preco-total { font-size: 1.10rem; color: #444; margin-top: .33em; font-weight: 500; display: block;}
  .preco-obs { display: block; margin-top: 0.34em; font-size: 0.92rem; color: #888; font-weight: 400; letter-spacing: 0.1px;}
  .btn-primary { background: var(--primary-color); color: var(--white); padding: 0.75rem 2.2rem; border: none; border-radius: 25px; font-size: 1.1rem; font-weight: 700; cursor: pointer; text-decoration: none; display: inline-block; transition: background var(--transition), color var(--transition); box-shadow: none; margin-top: 1.9rem;}
  .btn-primary:hover { background: var(--primary-dark); color: var(--white); box-shadow: none;}
  .carousel-arrow { position: absolute; top: 50%; transform: translateY(-50%); background: var(--primary-color); color: var(--white); border: none; border-radius: 50%; width: 48px; height: 48px; font-size: 2rem; cursor: pointer; outline: none; z-index: 2; opacity: 0.92; display: flex; align-items: center; justify-content: center; transition: background var(--transition), color var(--transition); box-shadow: none;}
  .carousel-arrow:active, .carousel-arrow:hover { background: var(--primary-dark); color: var(--white); box-shadow: none;}
  .carousel-arrow.left { left: 1rem;}
  .carousel-arrow.right { right: 1rem;}
  @media (max-width: 1000px) { .carousel-container { max-width: 700px;} .plano-card { min-width: 260px; max-width: 320px;} .nivel-titulo-item { font-size: 0.98rem; }}
  @media (max-width: 768px) { .carousel-container { max-width: 95vw;} .plano-card { min-width: 90vw; max-width: 90vw; margin: 0 0.5rem;} .carousel-arrow { width: 38px; height: 38px; font-size: 1.3rem;} .planos-titulo {font-size:1.3rem;} .nivel-titulo-item { font-size: 0.92rem; }}
  @keyframes fadeIn { from { opacity: 0.3; transform: translateY(22px);} to { opacity: 1; transform: translateY(0);}}
</style>

<section class="planos-section" id="planos">
  <h2 class="planos-titulo">Planos Personalizados para Cada Perfil</h2>
  <p class="planos-descricao">Escolha o perfil de cuidado e o período. Veja os valores por quarto.</p>
  <div class="nivel-container">
    <label style="display:block; font-weight:bold; margin-bottom:1.2rem; font-size:1.13rem;">
      Qual melhor descreve o seu familiar?
    </label>
    <div class="nivel-titulos">
      <span class="nivel-titulo-item">Paciente com baixa complexidade</span>
      <span class="nivel-titulo-item">Paciente com média complexidade</span>
      <span class="nivel-titulo-item">Paciente com alta complexidade</span>
    </div>
    <div class="nivel-slider-area">
      <div class="nivel-slider-bg"></div>
      <div class="nivel-slider-fill" id="nivelSliderFill"></div>
      <input type="range" id="nivelCuidados" min="1" max="3" value="1" class="nivel-slider">
      <div class="slider-markers">
        <span class="slider-dot" style="left:0%;"></span>
        <span class="slider-dot" style="left:50%;"></span>
        <span class="slider-dot" style="left:100%;"></span>
      </div>
    </div>
    <div class="nivel-labels" id="descricaoNivel"></div>
  </div>
  <div style="margin: 2rem 0; text-align:center;">
    <button class="plano-btn active" onclick="setFrequencia('semestral')">Semestral</button>
    <button class="plano-btn" onclick="setFrequencia('trimestral')">Trimestral</button>
    <button class="plano-btn" onclick="setFrequencia('mensal')">Mensal</button>
  </div>
  <div class="carousel-container" id="carouselContainer">
    <button class="carousel-arrow left" id="carouselPrevBtn">&#8592;</button>
    <div class="carousel-track" id="carouselTrack"></div>
    <button class="carousel-arrow right" id="carouselNextBtn">&#8594;</button>
  </div>
</section>

<script>
  // Frequência padrão alterada para 'semestral'
  let frequencia = 'semestral';
  const quartos = [
    { cod: "q3", label: "Quarto Triplo ou mais", img: "quarto3.jpg" },
    { cod: "q2", label: "Quarto Duplo", img: "quarto2.jpg" },
    { cod: "q1", label: "Quarto Individual", img: "quarto1.jpg" }
  ];
  // Textos de perfil
  const niveisResumo = [
    {
      titulo: "Paciente com baixa complexidade",
      descricao: "Seu familiar é independente para a maioria das tarefas e precisa apenas de supervisão leve e companhia."
    },
    {
      titulo: "Paciente com média complexidade",
      descricao: "Seu familiar necessita de auxílio parcial e acompanhamento em algumas atividades do dia a dia, como higiene, locomoção ou alimentação."
    },
    {
      titulo: "Paciente com alta complexidade",
      descricao: "Seu familiar precisa de suporte próximo e contínuo, com atenção total em todas as suas necessidades e bem-estar."
    }
  ];
  
  // New pricing multipliers and base prices:
  const roomBase = {
    q3: 3000,  // Triplo ou mais
    q2: 3500,  // Duplo
    q1: 4000   // Individual
  };
  const complexityMultipliers = [1.00, 1.15, 1.30]; // low, medium, high
  const frequencyMultipliers = {
    semestral: 1.00,
    trimestral: 1.15,
    mensal: 1.30
  };
  const mesesPorPlano = {
    semestral: 6,
    trimestral: 3,
    mensal: 1
  };

  function atualizarDescricaoNivel() {
    const nivel = parseInt(document.getElementById("nivelCuidados").value);
    const info = niveisResumo[nivel - 1];
    document.getElementById("descricaoNivel").innerHTML = `
      <div style="margin-top:10px;">
        <strong style="color:#2e7d32;">${info.titulo}</strong>
        <div style="font-size:0.98rem; color:#444; margin-top:4px;">${info.descricao}</div>
      </div>
    `;
  }

  function atualizarSliderPreenchimento() {
    const slider = document.getElementById("nivelCuidados");
    const fill = document.getElementById("nivelSliderFill");
    const min = parseInt(slider.min, 10);
    const max = parseInt(slider.max, 10);
    const val = parseInt(slider.value, 10);
    const percent = ((val - min) / (max - min));
    fill.style.width = `calc(${percent * 100}% - ${percent * 28}px + 14px)`;
    fill.style.background = "linear-gradient(90deg, #48BB78 0%, #FFD600 50%, #E53935 100%)";
    let thumbBorder;
    if (val === 1) thumbBorder = "#48BB78";
    else if (val === 2) thumbBorder = "#FFD600";
    else thumbBorder = "#E53935";
    slider.style.setProperty('--thumb-border', thumbBorder);
  }

  let currentIndex = 0;

  function setFrequencia(tipo) {
    frequencia = tipo;
    document.querySelectorAll('.plano-btn').forEach(btn => {
      btn.classList.remove('active');
      if (btn.textContent.toLowerCase().includes(tipo)) {
        btn.classList.add('active');
      }
    });
    atualizarCarousel();
  }

  function formatarPreco(valor) {
    return valor.toLocaleString('pt-BR', {
      style: 'currency',
      currency: 'BRL'
    });
  }

  function atualizarCarousel() {
    const nivel = parseInt(document.getElementById("nivelCuidados").value);
    const carouselTrack = document.getElementById('carouselTrack');
    carouselTrack.innerHTML = '';
    quartos.forEach((quarto, i) => {
      // Calculate monthly price using the room base price, complexity, and frequency multipliers
      let precoMensal = roomBase[quarto.cod] *
                        complexityMultipliers[nivel - 1] *
                        frequencyMultipliers[frequencia];
      const mesesPlano = mesesPorPlano[frequencia];
      const precoTotal = Math.round(precoMensal * mesesPlano);
      
      const perfil = niveisResumo[nivel - 1];
      const mensagem = 
`Olá! Gostaria de avançar na contratação para meu familiar.

Quarto: ${quarto.label}
Perfil: ${perfil.titulo}
${perfil.descricao}
Período: ${frequencia.charAt(0).toUpperCase() + frequencia.slice(1)}

Por favor, envie orientações sobre os próximos passos.`;

      const linkWhats = `https://wa.me/555197879151?text=${encodeURIComponent(mensagem)}`;

      const card = document.createElement('div');
      card.className = 'plano-card';
      card.innerHTML = `
        <img src="${quarto.img}" alt="${quarto.label}">
        <h3>${quarto.label}</h3>
        <div class="preco-profissional">
          <span class="preco-mensal">
            ${mesesPlano > 1 ? `<strong>${mesesPlano}x</strong> de` : ''} ${formatarPreco(Math.round(precoMensal))}
          </span>
          <span class="preco-total">
            Valor total do plano: <strong>${formatarPreco(precoTotal)}</strong>
          </span>
          <span class="preco-obs">
            * sujeito a alterações
          </span>
        </div>
        <a href="${linkWhats}" class="btn-primary" target="_blank">Contratar</a>
      `;
      carouselTrack.appendChild(card);
    });
    moveCarousel(currentIndex);
  }

  function moveCarousel(index) {
    const carouselTrack = document.getElementById('carouselTrack');
    const total = quartos.length;
    let visible = 3;
    if(window.innerWidth < 1000 && window.innerWidth >= 768) visible = 2;
    if(window.innerWidth < 768) visible = 1;
    if(index < 0) index = 0;
    if(index > total - visible) index = total - visible;
    currentIndex = index;
    const card = carouselTrack.querySelector('.plano-card');
    if(card) {
      const cardWidth = card.offsetWidth + 32;
      carouselTrack.style.transform = `translateX(-${index * cardWidth}px)`;
    }
    document.getElementById('carouselPrevBtn').style.visibility = (currentIndex === 0) ? "hidden" : "visible";
    document.getElementById('carouselNextBtn').style.visibility = (currentIndex >= (total - visible)) ? "hidden" : "visible";
  }

  document.addEventListener('DOMContentLoaded', () => {
    atualizarDescricaoNivel();
    atualizarSliderPreenchimento();
    atualizarCarousel();
    document.getElementById("nivelCuidados").addEventListener('input', function() {
      atualizarDescricaoNivel();
      atualizarSliderPreenchimento();
      atualizarCarousel();
    });
    document.getElementById('carouselPrevBtn').onclick = () => moveCarousel(currentIndex - 1);
    document.getElementById('carouselNextBtn').onclick = () => moveCarousel(currentIndex + 1);
    window.addEventListener('resize', () => moveCarousel(currentIndex));
  });
</script>